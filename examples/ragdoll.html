<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Testbed</title>
	<link rel="stylesheet" href="assets/example_main_styles.css">
</head>
<body class="fullscreen">
	<div id="container"></div>
	<script src="../libs/pixi.js"></script>
	<script src="../build/svjellymaker.js"></script>
	<script src="../build/pixirenderer.js"></script>
	<script>
		var loadEventHandler = function ()
		{
			var container = document.getElementById('container');
			container.width = document.body.clientWidth;
			var maker = window.svjelly.Maker.createFromConfig(container, '../examples/assets/ragdoll.json', window.innerWidth, window.innerHeight, 'min');
			maker.Renderer = window.svjelly.PixiRenderer;
			maker.initiated.then(function ()
			{
				container.style.width = maker.renderer.width + 'px';
				container.style.height = maker.renderer.height + 'px';
				maker.addBasicMouseControls(1000, 0);
				var head = maker.svjellyWorld.getGroupByID('head').physicsManager;
				var headBody = head.body;
				var cam = [head.getX(), head.getY()];
				var getVelocity = function ()
				{
					var vx = Math.abs(headBody.velocity[0]);
					var vy = Math.abs(headBody.velocity[1]);
					return (vx + vy);
				};
				var zoom = 10;

				maker.updateCallback = function ()
				{
					cam[0] = cam[0] + (head.getX() - cam[0]) * 0.1;
					cam[1] = cam[1] + (head.getY() - cam[1]) * 0.1;
					zoom = zoom + (Math.max(3, (10 - getVelocity() * 0.6)) - zoom) * 0.01;
					maker.renderer.setViewCenter(cam, zoom);
				};
			});
		};

		window.addEventListener('load', loadEventHandler);
	</script>
</body>
</html>